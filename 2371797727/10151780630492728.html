<!DOCTYPE html>
<html>
    <head>
        <title>Recover deleted files from ext3/ext4 partition on CentoS 6</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" >
    </head>
    <body>
        <b>TITLE OF THE DOCUMENT (just copy/paste it):</b>
        <div style="border: 2px solid; padding: 10px; margin: 10px 50px 50px;">
             Recover deleted files from ext3/ext4 partition on CentoS 6
        </div>

        <b>CONTENT OF THE DOCUMENT (just copy/paste it):</b>
        <div style="border: 2px solid; padding: 10px; margin: 10px 50px;">
            <p>How to recover deleted files<br /><br />I used ext4 magic, replacement for extundelete and ext3grep:<br /><a href="http://l.facebook.com/l.php?u=http%3A%2F%2Fopenfacts2.berlios.de%2Fwikien%2Findex.php%2FBerliosProject%3AExt4magic&amp;h=PAQEdOxCf&amp;s=1" target="_blank" rel="nofollow" onmouseover="LinkshimAsyncLink.swap(this, &quot;http:\/\/openfacts2.berlios.de\/wikien\/index.php\/BerliosProject:Ext4magic&quot;);" onclick="LinkshimAsyncLink.swap(this, &quot;http:\/\/l.facebook.com\/l.php?u=http\u00253A\u00252F\u00252Fopenfacts2.berlios.de\u00252Fwikien\u00252Findex.php\u00252FBerliosProject\u00253AExt4magic&amp;h=PAQEdOxCf&amp;s=1&quot;);">http://openfacts2.berlios.de/wikien/index.php/BerliosProject:Ext4magic</a><br /><br />I have rpm&#039;s for CentOS 6 I downloaded from somewhere at:<br /><a href="http://l.facebook.com/l.php?u=http%3A%2F%2Frpms.plnet.rs%2Fplnet-centos6-i386%2FRPMS.plnet-downloaded%2Fext4magic-0.3.1-1.2.i686.rpm&amp;h=TAQErREsC&amp;s=1" target="_blank" rel="nofollow" onmouseover="LinkshimAsyncLink.swap(this, &quot;http:\/\/rpms.plnet.rs\/plnet-centos6-i386\/RPMS.plnet-downloaded\/ext4magic-0.3.1-1.2.i686.rpm&quot;);" onclick="LinkshimAsyncLink.swap(this, &quot;http:\/\/l.facebook.com\/l.php?u=http\u00253A\u00252F\u00252Frpms.plnet.rs\u00252Fplnet-centos6-i386\u00252FRPMS.plnet-downloaded\u00252Fext4magic-0.3.1-1.2.i686.rpm&amp;h=TAQErREsC&amp;s=1&quot;);">http://rpms.plnet.rs/plnet-centos6-i386/RPMS.plnet-downloaded/ext4magic-0.3.1-1.2.i686.rpm</a><br /><a href="http://l.facebook.com/l.php?u=http%3A%2F%2Frpms.plnet.rs%2Fplnet-centos6-x86_64%2FRPMS.plnet-downloaded%2Fext4magic-0.3.1-1.2.x86_64.rpm&amp;h=GAQGMIVNW&amp;s=1" target="_blank" rel="nofollow" onmouseover="LinkshimAsyncLink.swap(this, &quot;http:\/\/rpms.plnet.rs\/plnet-centos6-x86_64\/RPMS.plnet-downloaded\/ext4magic-0.3.1-1.2.x86_64.rpm&quot;);" onclick="LinkshimAsyncLink.swap(this, &quot;http:\/\/l.facebook.com\/l.php?u=http\u00253A\u00252F\u00252Frpms.plnet.rs\u00252Fplnet-centos6-x86_64\u00252FRPMS.plnet-downloaded\u00252Fext4magic-0.3.1-1.2.x86_64.rpm&amp;h=GAQGMIVNW&amp;s=1&quot;);">http://rpms.plnet.rs/plnet-centos6-x86_64/RPMS.plnet-downloaded/ext4magic-0.3.1-1.2.x86_64.rpm</a><br /><br />What to do:<br /><br />1. First thing to do is to unmount that partition and stop using it. If it is root partition, shutdown system and boot LiveCD/LiveDVD 6.x and work from it<br /><br />2. Create a copy of your partition (to a filesystem where you have enough free space!):<br />dd if=/dev/DEVICE of=/BACKUPPATH/DEVICE.img<br /><br />3. Create a backup of ext3/ext4 Journal:<br />debugfs -R &quot;dump &lt;8&gt; /BACKUPPATH/journal.copy&quot; /dev/DEVICE<br /><br />4. Download and install ext4magic rpm:<br /><br />CentOS i386 - for 32-bit system/LiveCD:<br />wget <a href="http://l.facebook.com/l.php?u=http%3A%2F%2Frpms.plnet.rs%2Fplnet-centos6-i386%2FRPMS.plnet-downloaded%2Fext4magic-0.3.1-1.2.i686.rpm&amp;h=0AQEnzBMn&amp;s=1" target="_blank" rel="nofollow" onmouseover="LinkshimAsyncLink.swap(this, &quot;http:\/\/rpms.plnet.rs\/plnet-centos6-i386\/RPMS.plnet-downloaded\/ext4magic-0.3.1-1.2.i686.rpm&quot;);" onclick="LinkshimAsyncLink.swap(this, &quot;http:\/\/l.facebook.com\/l.php?u=http\u00253A\u00252F\u00252Frpms.plnet.rs\u00252Fplnet-centos6-i386\u00252FRPMS.plnet-downloaded\u00252Fext4magic-0.3.1-1.2.i686.rpm&amp;h=0AQEnzBMn&amp;s=1&quot;);">http://rpms.plnet.rs/plnet-centos6-i386/RPMS.plnet-downloaded/ext4magic-0.3.1-1.2.i686.rpm</a><br />yum install ext4magic-0.3.1-1.2.i686.rpm<br /><br />CentOS 6 x86_64:<br />wget <a href="http://l.facebook.com/l.php?u=http%3A%2F%2Frpms.plnet.rs%2Fplnet-centos6-x86_64%2FRPMS.plnet-downloaded%2Fext4magic-0.3.1-1.2.x86_64.rpm&amp;h=KAQF3InBc&amp;s=1" target="_blank" rel="nofollow" onmouseover="LinkshimAsyncLink.swap(this, &quot;http:\/\/rpms.plnet.rs\/plnet-centos6-x86_64\/RPMS.plnet-downloaded\/ext4magic-0.3.1-1.2.x86_64.rpm&quot;);" onclick="LinkshimAsyncLink.swap(this, &quot;http:\/\/l.facebook.com\/l.php?u=http\u00253A\u00252F\u00252Frpms.plnet.rs\u00252Fplnet-centos6-x86_64\u00252FRPMS.plnet-downloaded\u00252Fext4magic-0.3.1-1.2.x86_64.rpm&amp;h=KAQF3InBc&amp;s=1&quot;);">http://rpms.plnet.rs/plnet-centos6-x86_64/RPMS.plnet-downloaded/ext4magic-0.3.1-1.2.x86_64.rpm</a><br />yum install ext4magic-0.3.1-1.2.x86_64.rpm<br /><br />5a. Run ext4magic on the copy/dd-image to recover all deleted files (-m switch):<br /><br />ext4magic /BACKUPPATH/DEVICE.img -m -j /BACKUPPATH/journal.copy<br /><br />5b. Run ext4magic on the actual partition (not recomended!):<br /><br />ext4magic /dev/DEVICE -j /BACKUPPATH/journal.copy -m<br /><br />5c. Recovers all files deleted the last 24 hours from directory <i><b>user1/</b></i> which have the string <i><b>jpg</b></i> in their filename. The recovered files are stored at /LOCATION_TO_SAVE_FILES. A temporary file <i><b>./tmpfile</b></i> is used to get the list of filenames to recover.
:<br /><br />ext4magic /BACKUPPATH/DEVICE.img -Lx -f user1 | grep &quot;jpg&quot; &gt; ./tmpfile<br />ext4magic /BACKUPPATH/DEVICE.img -i ./tmpfile -r -d /LOCATION_TO_SAVE_FILES<br /><br />5d. Since the files were delete 4 days ago, I decided to R recover (everything) after 5 days ago and before 2 days ago:<br /><br />ext4magic -R -a $(date -d “-5day” +%s) -b $(date -d “-2day” +%s) \ -d /LOCATION_TO_SAVE_FILES /BACKUPPATH/DEVICE.img<br /><br />More help:<br /><a href="http://l.facebook.com/l.php?u=http%3A%2F%2Fsource.kohlerville.com%2F2013%2F02%2Fext4-recover-deleted-files-undelete-using-ext4magic-on-centos-6%2F&amp;h=7AQH0UM6t&amp;s=1" target="_blank" rel="nofollow" onmouseover="LinkshimAsyncLink.swap(this, &quot;http:\/\/source.kohlerville.com\/2013\/02\/ext4-recover-deleted-files-undelete-using-ext4magic-on-centos-6\/&quot;);" onclick="LinkshimAsyncLink.swap(this, &quot;http:\/\/l.facebook.com\/l.php?u=http\u00253A\u00252F\u00252Fsource.kohlerville.com\u00252F2013\u00252F02\u00252Fext4-recover-deleted-files-undelete-using-ext4magic-on-centos-6\u00252F&amp;h=7AQH0UM6t&amp;s=1&quot;);">http://source.kohlerville.com/2013/02/ext4-recover-deleted-files-undelete-using-ext4magic-on-centos-6/</a><br /><br />You can use &quot;man ext4magic&quot; to get more help.<br /></p>
        </div>
    </body>
</html>
